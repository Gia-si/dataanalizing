
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environmental Data Hub</title>
    <link href="[https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap](https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap)" rel="stylesheet">
    <link rel="stylesheet" href="[https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css](https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css)">
    <script src="[https://cdn.tailwindcss.com](https://cdn.tailwindcss.com)"></script>
    <style>
        /* Base Styles */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f06, #a1c4fd); /* Gradient background */
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center; /* Center horizontally */
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden; /* Prevent horizontal scrolling */
            padding-top: 30px; /* Add some padding at the top */
        }

        /* Main Title */
        h1#mainTitle {
            font-size: 2.8rem; /* Larger main title */
            color: #fff;
            text-align: center;
            margin-bottom: 25px; /* Reduced margin */
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3); /* Stronger text shadow */
            font-weight: 700;
        }

        /* Navigation Buttons Container */
        .nav-buttons {
            display: flex;
            gap: 20px;
            margin-bottom: 20px; /* Reduced space below buttons */
            z-index: 10; /* Ensure buttons are above other content */
        }

        .nav-button {
            background-color: #6a75ff;
            color: #fff;
            padding: 12px 28px; /* Adjusted padding */
            border: none;
            border-radius: 25px; /* More rounded */
            font-size: 1.15rem; /* Slightly larger font */
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.25); /* Enhanced shadow */
        }

        .nav-button:hover {
            background-color: #4a59cc;
            transform: translateY(-4px); /* More pronounced lift on hover */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.35);
        }

        .nav-button.active {
            background-color: #00bcd4; /* Active button highlight */
            box-shadow: 0 0 20px rgba(0, 188, 212, 0.7); /* Glow effect for active */
            transform: translateY(-2px); /* Slight lift for active */
        }

        /* Content Sections (Dashboard and Data Analysis) */
        .content-section {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 15px; /* More rounded corners */
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.2); /* Deeper shadow */
            width: 100%;
            max-width: 950px; /* Adjusted max-width for better fit */
            margin-top: 15px; /* Crucial: Reduced space from buttons */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            display: none; /* Hidden by default */
            box-sizing: border-box; /* Include padding in width */
        }

        .content-section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* Dashboard Specific Styles */
        .dashboard-main-title {
            font-size: 2.2rem;
            color: #333; /* Adjusted to be darker on white background */
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Adjusted minwidth for better responsiveness */
            gap: 24px;
            width: 100%;
        }

        .parameter-card {
            background-color: #f8f8f8; /* Slightly off-white for cards */
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .parameter-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .parameter-card i {
            font-size: 2.5rem;
            color: #6a75ff; /* A consistent blue for icons */
        }

        .parameter-card h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #555;
        }

        .parameter-card p {
            font-size: 1.8rem; /* Slightly larger values */
            font-weight: 700;
            color: #222;
        }

        /* Data Analysis Specific Styles */
        .analysis-h1 { /* Changed from h1 to a specific class for this section's title */
            font-size: 2.2rem; /* Consistent with dashboard title */
            color: #333;
            text-align: center;
            margin-bottom: 30px; /* Reduced margin */
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.08);
        }

        .analysis-container { /* Renamed from .container to avoid conflict and be specific */
            background-color: #ffffff;
            padding: 35px; /* Adjusted padding for more space */
            border-radius: 15px; /* More rounded */
            box-shadow: 0px 6px 20px rgba(0, 0, 0, 0.15); /* Stronger shadow */
            width: 100%;
            max-width: 800px; /* Increased max-width */
            margin: 0 auto; /* Center the form */
            box-sizing: border-box;
            border: 1px solid #e0e0e0; /* Subtle border */
        }

        .form-group {
            margin-bottom: 22px; /* Increased spacing */
        }

        .form-group label {
            font-size: 1.05rem; /* Slightly larger label font */
            margin-bottom: 8px;
            color: #444; /* Darker label color */
            font-weight: 600;
        }

        .form-group input[type="number"] {
            padding: 12px 16px; /* Increased padding */
            font-size: 1rem; /* Slightly larger input font */
            border-radius: 8px; /* More rounded inputs */
            border: 1px solid #ccc; /* Softer border */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.08); /* Inner shadow */
            transition: all 0.3s ease;
        }

        .form-group input[type="number"]:focus {
            border-color: #4a59cc; /* Stronger focus border */
            box-shadow: 0 0 0 3px rgba(106, 117, 255, 0.25); /* Glow on focus */
            outline: none;
        }

        .action-button { /* General style for action buttons within analysis */
            background: linear-gradient(135deg, #6a75ff, #00bcd4); /* Gradient button */
            color: #fff;
            padding: 14px 30px; /* Larger padding */
            border: none;
            border-radius: 10px; /* More rounded */
            font-size: 1.2rem; /* Larger font */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%; /* Full width for main analysis button */
            margin-top: 20px; /* More space */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .action-button:hover {
            background: linear-gradient(135deg, #4a59cc, #0097a7); /* Darker gradient on hover */
            transform: translateY(-3px); /* Lift more on hover */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        #results, #suggestion {
            background-color: #ffffff; /* White background */
            padding: 40px; /* Increased padding */
            border-radius: 15px; /* More rounded */
            box-shadow: 0px 6px 20px rgba(0, 0, 0, 0.15); /* Stronger shadow */
            width: 100%;
            max-width: 800px; /* Increased max-width */
            display: none;
            margin: 30px auto 0; /* Center results and suggestion */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            box-sizing: border-box;
            border: 1px solid #e0e0e0; /* Subtle border */
        }

        #results.show, #suggestion.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        #summary {
            font-size: 1.2rem; /* Larger summary font */
            color: #333;
            text-align: center;
            margin-bottom: 25px; /* More space */
            font-weight: 600;
        }

        .result-item {
            padding: 15px; /* More padding */
            margin-bottom: 15px; /* More spacing */
            border-radius: 8px; /* More rounded */
            font-weight: 600;
            line-height: 1.6; /* Improved line height */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); /* Subtle shadow for items */
        }

        .danger { background-color: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5; } /* Softer red */
        .ideal { background-color: #dcfce7; color: #15803d; border: 1px solid #86efac; } /* Softer green */
        .warning { background-color: #fffbeb; color: #b45309; border: 1px solid #fcd34d; } /* Softer yellow */

        #results .action-button,
        #suggestion .action-button {
            background: linear-gradient(135deg, #ef4444, #dc2626); /* Red gradient for back/suggestions */
            display: inline-block;
            width: auto;
            margin: 15px 12px 0 0; /* Increased spacing */
            padding: 12px 25px; /* Adjusted padding */
            font-size: 1.1rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        #results .action-button:last-child,
        #suggestion .action-button:last-child {
            margin-right: 0;
        }

        #results .action-button:hover,
        #suggestion .action-button:hover {
            background: linear-gradient(135deg, #b91c1c, #991b1b); /* Darker red gradient on hover */
        }

        .fade-out {
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        #suggestionContent {
            font-size: 1.15rem;
            color: #333;
            text-align: left;
            line-height: 1.8; /* More comfortable line height */
        }
        #suggestionContent div {
             margin-bottom: 15px; /* More space between suggestion items */
        }
    </style>
</head>
<body>

    <h1 id="mainTitle">Environmental Data Hub</h1>

    <div class="nav-buttons">
        <button id="dashboardBtn" class="nav-button active" onclick="switchPage('dashboard')">Bảng Điều Khiển</button>
        <button id="analysisBtn" class="nav-button" onclick="switchPage('analysis')">Phân Tích Dữ Liệu</button>
    </div>

    <!-- Page 1: Environmental Dashboard -->
    <div id="dashboardSection" class="content-section active">
        <h2 class="dashboard-main-title">Environmental Condition - Điều Kiện Môi Trường</h2>

        <!-- Hidden Checkboxes for EraWidget (Dashboard) -->
        <input type="checkbox" id="phCheckbox" style="display:none;">
        <input type="checkbox" id="doCheckbox" style="display:none;">
        <input type="checkbox" id="ecCheckbox" style="display:none;">
        <input type="checkbox" id="atCheckbox" style="display:none;">
        <input type="checkbox" id="wtCheckbox" style="display:none;">
        <input type="checkbox" id="hmCheckbox" style="display:none;">
        <input type="checkbox" id="wfCheckbox" style="display:none;">
        <input type="checkbox" id="wlCheckbox" style="display:none;">
        <input type="checkbox" id="tdsCheckbox" style="display:none;">
        <input type="checkbox" id="liCheckbox" style="display:none;">

        <script src="https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const eraWidget = new EraWidget();

      let configPh = null, configDo = null, configEc = null, configAt = null,
          configWt = null, configHm = null, configTds = null,
          configWf = null, configWl = null, configLi = null;

      eraWidget.init({
        onConfiguration: (configuration) => {
          configPh  = configuration.realtime_configs.find(cfg => cfg.name === 'PH');
          configDo  = configuration.realtime_configs.find(cfg => cfg.name === 'DO');
          configEc  = configuration.realtime_configs.find(cfg => cfg.name === 'EC');
          configWt  = configuration.realtime_configs.find(cfg => cfg.name === 'TO');
          configTds = configuration.realtime_configs.find(cfg => cfg.name === 'TDS');
          configLi  = configuration.realtime_configs.find(cfg => cfg.name === 'LUX');
          configAt  = configuration.realtime_configs.find(cfg => cfg.name === 'TEMP');
          configHm  = configuration.realtime_configs.find(cfg => cfg.name === 'HUMID');
          configWf  = configuration.realtime_configs.find(cfg => cfg.name === 'WF');
          configWl  = configuration.realtime_configs.find(cfg => cfg.name === 'WL');
        },

        onValues: (values) => {
          const updateUI = (config, id, checkboxId) => {
            if (config && values[config.id]) {
              const val = values[config.id].value;
              document.getElementById(id).innerText = val.toFixed(2);
              document.getElementById(checkboxId).checked = val > 0;
            }
          };

          updateUI(configPh,  'ph',        'phCheckbox');
          updateUI(configDo,  'do',        'doCheckbox');
          updateUI(configEc,  'ec',        'ecCheckbox');
          updateUI(configWt,  'watertemp', 'wtCheckbox');
          updateUI(configTds, 'tds',       'tdsCheckbox');
          updateUI(configLi,  'li',        'liCheckbox');
          updateUI(configAt,  'airtemp',   'atCheckbox');
          updateUI(configHm,  'hm',        'hmCheckbox');
          updateUI(configWf,  'wf',        'wfCheckbox');
          updateUI(configWl,  'wl',        'wlCheckbox');
        },
      });

      // Đảm bảo gọi sau khi DOM và widget sẵn sàng
      eraWidget.ready();
    });
  </script>
        <main class="grid-container">
            <!-- Parameter Cards -->
            <div class="parameter-card">
                <i class="fas fa-tint text-blue-500"></i>
                <div>
                    <h3>pH</h3>
                    <p id="ph"></p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-wind text-green-500"></i>
                <div>
                    <h3>DO (Dissolved Oxygen)</h3>
                    <p id="do"> mg/L</p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-flask text-purple-500"></i>
                <div>
                    <h3>EC</h3>
                    <p id="ec"> µS/cm</p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-water text-teal-500"></i>
                <div>
                    <h3>TDS</h3>
                    <p id="tds"> ppm</p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-thermometer-half text-red-500"></i>
                <div>
                    <h3>Air Temperature</h3>
                    <p id="airtemp"> °C</p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-thermometer-three-quarters text-cyan-500"></i>
                <div>
                    <h3>Water Temperature</h3>
                    <p id="watertemp"> °C</p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-cloud-sun text-yellow-500"></i>
                <div>
                    <h3>Humidity</h3>
                    <p id="hm"> %</p>
                </div>
            </div>

            <div class="parameter-card">
                <i class="fas fa-water-arrow-down text-indigo-500"></i>
                <div>
                    <h3>Water Flow</h3>
                    <p id="wf"> L/min</p>
                </div>
            </div>

            <div class="parameter-card col-span-full sm:col-span-1 md:col-start-2">
                <i class="fas fa-tachometer-alt text-pink-500"></i>
                <div>
                    <h3>Water Level</h3>
                    <p id="wl"></p>
                </div>
            </div>

            <div class="parameter-card col-span-full sm:col-span-1 md:col-span-1">
                <i class="fas fa-lightbulb text-yellow-400"></i>
                <div>
                    <h3>Light Intensity</h3>
                    <p id="li"> lux</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Page 2: Data Analysis Form -->
    <div id="analysisSection" class="content-section">
        <h2 class="analysis-h1">BẢNG PHÂN TÍCH DỮ LIỆU</h2>
        <!-- Input Form -->
        <div class="analysis-container" id="formContainer">
            <form id="dataForm">
                <div class="form-group"><label for="tdsInput">TDS (mg/L):</label><input type="number" id="tdsInput" step="1" required value="0"></div>
                <div class="form-group"><label for="ecInput">EC (mS/cm):</label><input type="number" id="ecInput" step="1" required value="0"></div>
                <div class="form-group"><label for="doInput">Oxygen (mg/L):</label><input type="number" id="doInput" step="0.01" required value="0"></div>
                <div class="form-group"><label for="airtempInput">Air Temperature (°C):</label><input type="number" id="airtempInput" step="1" required value="0"></div>
                <div class="form-group"><label for="watertempInput">Water Temperature (°C):</label><input type="number" id="watertempInput" step="1" required value="0"></div>
                <div class="form-group"><label for="phInput">pH:</label><input type="number" id="phInput" step="0.1" required value="0"></div>
                <div class="form-group"><label for="lightInput">Light:</label><input type="number" id="lightInput" step="1" required value="0"></div>
                <div class="form-group"><label for="hmInput">Humidity (%):</label><input type="number" id="hmInput" step="1" required value="0"></div>
                <button type="button" class="action-button" onclick="analyzeData()">PHÂN TÍCH</button>
            </form>
        </div>

        <div id="results">
            <div id="summary"></div>
            <button class="action-button" onclick="goBack()">QUAY LẠI</button>
            <button class="action-button" onclick="showSuggestion()">LẤY LỜI KHUYÊN</button>
        </div>

        <!-- Suggestion Page -->
        <div id="suggestion">
            <div class="analysis-container"> <!-- Use analysis-container for styling consistency -->
                <div id="suggestionContent"></div>
                <button class="action-button" onclick="goBackToForm()">QUAY LẠI</button>
            </div>
        </div>
    </div>

    <script src="[https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js](https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js)"></script>
    <script>
        // Global variables for EraWidget configurations
        let eraConfigs = {}; // Store all configurations received

        document.addEventListener('DOMContentLoaded', () => {
            const eraWidget = new EraWidget();

            eraWidget.init({
                onConfiguration: (configuration) => {
                    // Store all configurations in a dictionary for easy access
                    configuration.realtime_configs.forEach(cfg => {
                        eraConfigs[cfg.name] = cfg;
                    });
                },

                onValues: (values) => {
                    // Function to update UI elements (dashboard displays and analysis inputs)
                    const updateUI = (configName, displayId, inputId = null, unit = '', precision = 2) => {
                        const config = eraConfigs[configName];
                        if (config && values[config.id]) {
                            const val = values[config.id].value;
                            // Update dashboard display
                            const displayElement = document.getElementById(displayId);
                            if (displayElement) {
                                displayElement.innerText = val.toFixed(precision) + (unit ? ` ${unit}` : '');
                            }
                            // Update analysis input if provided and the analysis section is active
                            if (inputId && document.getElementById('analysisSection').classList.contains('active')) {
                                const inputElement = document.getElementById(inputId);
                                if (inputElement) {
                                    inputElement.value = val.toFixed(precision);
                                }
                            }
                            // Update hidden checkboxes
                            const checkboxId = `${displayId}Checkbox`;
                            const checkbox = document.getElementById(checkboxId);
                            if (checkbox) {
                                checkbox.checked = val > 0;
                            }
                        }
                    };

                    // Update Dashboard UI elements and optionally analysis inputs
                    updateUI('PH', 'phDisplay', 'phInput');
                    updateUI('DO', 'doDisplay', 'doInput', 'mg/L');
                    updateUI('EC', 'ecDisplay', 'ecInput', 'µS/cm');
                    updateUI('TO', 'watertempDisplay', 'watertempInput', '°C'); // TO is Water Temp
                    updateUI('TDS', 'tdsDisplay', 'tdsInput', 'ppm');
                    updateUI('LUX', 'liDisplay', 'lightInput', 'lux'); // LUX is Light Intensity
                    updateUI('TEMP', 'airtempDisplay', 'airtempInput', '°C'); // TEMP is Air Temp
                    updateUI('HUMID', 'hmDisplay', 'hmInput', '%');
                    updateUI('WF', 'wfDisplay', null, 'L/min'); // No input for Water Flow
                    updateUI('WL', 'wlDisplay', null); // No input for Water Level
                },
            });
            eraWidget.ready();

            // Set initial page to Dashboard and activate its button
            switchPage('dashboard');
        });

        // Function to switch between dashboard and analysis pages
        function switchPage(pageId) {
            const dashboardSection = document.getElementById('dashboardSection');
            const analysisSection = document.getElementById('analysisSection');
            const dashboardBtn = document.getElementById('dashboardBtn');
            const analysisBtn = document.getElementById('analysisBtn');
            const mainTitle = document.getElementById('mainTitle');

            // Hide all pages and deactivate all buttons
            dashboardSection.classList.remove('active');
            analysisSection.classList.remove('active');
            dashboardBtn.classList.remove('active');
            analysisBtn.classList.remove('active');

            // Show the selected page and activate its button
            if (pageId === 'dashboard') {
                dashboardSection.classList.add('active');
                dashboardBtn.classList.add('active');
                mainTitle.innerText = "Environmental Data Hub"; // Main title for dashboard view
            } else if (pageId === 'analysis') {
                analysisSection.classList.add('active');
                analysisBtn.classList.add('active');
                mainTitle.innerText = "Environmental Data Analysis"; // Main title for analysis view
                populateAnalysisFormFromDashboard(); // Populate form inputs when switching to analysis
            }
        }

        // Function to populate analysis form with current dashboard values
        function populateAnalysisFormFromDashboard() {
            // Get values from dashboard elements
            const phVal = parseFloat(document.getElementById('phDisplay').innerText);
            const doVal = parseFloat(document.getElementById('doDisplay').innerText);
            const ecVal = parseFloat(document.getElementById('ecDisplay').innerText);
            const airtempVal = parseFloat(document.getElementById('airtempDisplay').innerText);
            const watertempVal = parseFloat(document.getElementById('watertempDisplay').innerText);
            const tdsVal = parseFloat(document.getElementById('tdsDisplay').innerText);
            const lightVal = parseFloat(document.getElementById('liDisplay').innerText);
            const hmVal = parseFloat(document.getElementById('hmDisplay').innerText);

            // Populate the analysis form inputs with these values, only if they are valid numbers
            if (!isNaN(tdsVal)) document.getElementById('tdsInput').value = tdsVal;
            if (!isNaN(ecVal)) document.getElementById('ecInput').value = ecVal;
            if (!isNaN(doVal)) document.getElementById('doInput').value = doVal;
            if (!isNaN(airtempVal)) document.getElementById('airtempInput').value = airtempVal;
            if (!isNaN(watertempVal)) document.getElementById('watertempInput').value = watertempVal;
            if (!isNaN(phVal)) document.getElementById('phInput').value = phVal;
            if (!isNaN(lightVal)) document.getElementById('lightInput').value = lightVal;
            if (!isNaN(hmVal)) document.getElementById('hmInput').value = hmVal;
        }

        // --- Data Analysis Logic (from your original code) ---
        function analyzeData() {
            const tds = parseFloat(document.getElementById('tdsInput').value);
            const ec = parseFloat(document.getElementById('ecInput').value);
            const doValue = parseFloat(document.getElementById('doInput').value);
            const airtemp = parseFloat(document.getElementById('airtempInput').value);
            const ph = parseFloat(document.getElementById('phInput').value);
            const watertemp = parseFloat(document.getElementById('watertempInput').value);
            const light = parseFloat(document.getElementById('lightInput').value);
            const humid = parseFloat(document.getElementById('hmInput').value);

            let summary = '';
            //TDS
            if (tds < 300) summary += "<div class='result-item danger'>TDS THẤP: CÁ thiếu khoáng chất !!</div>";
            else if (tds <= 500) summary += "<div class='result-item ideal'>TDS LÝ TƯỞNG: ĐẠT MỨC ĐỘ ỔN ĐỊNH</div>";
            else summary += "<div class='result-item warning'>TDS CAO: Cá có thể bị sốc nước</div>";
            //EC
            if (ec < 0.8) summary += "<div class='result-item warning'>EC THẤP: Cá thiếu khoáng chất</div>";
            else if (ec <= 1.5) summary += "<div class='result-item ideal'>EC PHÙ HỢP</div>";
            else summary += "<div class='result-item danger'>EC CAO: Có thể gây sốc</div>";
            //DO
            if (doValue <= 4) summary += "<div class='result-item danger'>DO RẤT THẤP: Cá có thể tử vong</div>";
            else if (doValue < 8) summary += "<div class='result-item warning'>DO HƠI THẤP: Ảnh hưởng sinh trưởng</div>";
            else if (doValue <= 10) summary += "<div class='result-item ideal'>DO LÝ TƯỞNG</div>";
            else summary += "<div class='result-item warning'>DO CAO: Hyperoxia có thể xảy ra</div>";
            //airtemp
            if (airtemp < 18) summary += "<div class='result-item warning'>NHIỆT ĐỘ KHÍ THẤP: Cây phát triển chậm</div>";
            else if (airtemp < 24) summary += "<div class='result-item ideal'>NHIỆT ĐỘ KHÍ PHÙ HỢP</div>";
            else summary += "<div class='result-item warning'>NHIỆT ĐỘ KHÍ CAO: Cây bị héo</div>";
            //watertemp
            if (watertemp < 12) summary += "<div class='result-item danger'>NHIỆT ĐỘ NƯỚC RẤT THẤP</div>";
            else if (watertemp <= 14) summary += "<div class='result-item warning'>NHIỆT ĐỘ NƯỚC HƠI THẤP</div>";
            else if (watertemp <= 20) summary += "<div class='result-item ideal'>NHIỆT ĐỘ NƯỚC PHÙ HỢP</div>";
            else summary += "<div class='result-item danger'>NHIỆT ĐỘ NƯỚC CAO</div>";
            //PH
            if (ph < 6) summary += "<div class='result-item danger'>PH THẤP: Cá có thể gặp tình trạng độc tố</div>";
            else if (ph <= 7) summary += "<div class='result-item ideal'>PH LÝ TƯỞNG: ĐẠT MỨC ĐỘ ỔN ĐỊNH</div>";
            else summary += "<div class='result-item danger'>PH CAO: Làm giảm khả năng hấp thụ Oxy</div>";
            //light
            if (light < 12000) summary += "<div class='result-item warning'>ÁNH SÁNG THẤP</div>";
            else if (light <= 18000) summary += "<div class='result-item ideal'>ÁNH SÁNG PHÙ HỢP</div>";
            else summary += "<div class='result-item danger'>ÁNH SÁNG CAO</div>";
            //Humid
            if (humid < 50) summary += "<div class='result-item warning'>ĐỘ ẨM THẤP: Làm cây khó giữ nước, tăng quá trình bốc hơi nước từ cá và bể</div>";
            else if (humid <= 70) summary += "<div class='result-item ideal'>ĐỘ ẨM PHÙ HỢP</div>";
            else summary += "<div class='result-item danger'>ĐỘ ẨM CAO: Cây nấm mốc, bệnh thối rễ,... giảm khả năng trao đổi Oxy của cá</div>";

            document.getElementById('summary').innerHTML = summary;

            const formContainer = document.getElementById('formContainer');
            formContainer.classList.add('fade-out');

            setTimeout(() => {
                formContainer.style.display = "none";
                const resultDiv = document.getElementById('results');
                resultDiv.style.display = "block";
                resultDiv.classList.add('show');
            }, 500);
        }

        function goBack() {
            const resultDiv = document.getElementById('results');
            resultDiv.classList.remove('show');
            setTimeout(() => {
                resultDiv.style.display = "none";
                const formContainer = document.getElementById('formContainer');
                formContainer.style.display = "block";
                formContainer.classList.remove('fade-out');
            }, 500);
        }

        function showSuggestion() {
            const tds = parseFloat(document.getElementById('tdsInput').value);
            const ec = parseFloat(document.getElementById('ecInput').value);
            const doValue = parseFloat(document.getElementById('doInput').value);
            const airtemp = parseFloat(document.getElementById('airtempInput').value);
            const ph = parseFloat(document.getElementById('phInput').value);
            const light = parseFloat(document.getElementById('lightInput').value);
            const humid = parseFloat(document.getElementById('hmInput').value);

            const suggestionDiv = document.getElementById('suggestion');
            const suggestionContent = document.getElementById('suggestionContent');
            const resultDiv = document.getElementById('results');

            resultDiv.classList.remove('show');

            setTimeout(() => {
                resultDiv.style.display = 'none';
                suggestionDiv.style.display = 'block';
                setTimeout(() => {
                    suggestionDiv.style.opacity = 1;
                    suggestionDiv.style.transform = 'translateY(0)';
                }, 50);
            }, 500);

            // Populate suggestion content
            suggestionContent.innerHTML = '';
            if (tds < 300) {
                suggestionContent.innerHTML += "<div class='warning'>TDS Thấp: Bổ sung khoáng chất: Canxi, Kali, Magie... (Theo dõi tránh TDS tăng nhanh)</div>";
            } else if (tds > 500) {
                suggestionContent.innerHTML += "<div class='warning'>TDS Cao: Thay một phần nước bằng nước lọc hoặc nước mưa an toàn để pha loãng; có thể vệ sinh hệ thống</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>TDS Lý tưởng: Không cần điều chỉnh thêm</div>";
            }

            if (ec < 0.8) {
                suggestionContent.innerHTML += "<div class='warning'>EC Thấp: Bổ sung khoáng chất: Canxi, Kali, sắt... và vi lượng cho nước</div>";
            } else if (ec > 1.5) {
                suggestionContent.innerHTML += "<div class='warning'>EC Cao: Thay một phần nước, tăng cường bộ lọc sinh học, ngưng bổ sung khoáng chất</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>EC Lý tưởng: Không cần điều chỉnh thêm</div>";
            }

            if (doValue < 4) {
                suggestionContent.innerHTML += "<div class='warning'>DO Thấp: Tăng cường sục khí, giảm nhiệt nước nếu quá cao, giảm mật độ cá nếu quá dày</div>";
            } else if (doValue > 10) {
                suggestionContent.innerHTML += "<div class='warning'>DO Cao: Giảm sục khí, tăng nhiệt nước nếu quá thấp, giảm mật độ cá(cân nhắc)</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>DO Lý tưởng: Không cần điều chỉnh thêm</div>";
            }

            if (airtemp < 14) {
                suggestionContent.innerHTML += "<div class='warning'>Nhiệt Khí Thấp: Dùng máy sưởi không khí, quạt thông gió, cách nhiệt bể</div>";
            } else if (airtemp > 20) {
                suggestionContent.innerHTML += "<div class='warning'>Nhiệt Khí Cao: Tăng cường thông gió, thoát nhiệt, che nắng, phun sương</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>Nhiệt Khí Lý Tưởng: Không cần điều chỉnh thêm</div>";
            }

            if (ph < 6) {
                suggestionContent.innerHTML += "<div class='warning'>PH Thấp: Bổ sung Canxi, Kali,.. Lưu ý tăng từ từ: 0,2 -> 0,3 / 1 ngày</div>";
            } else if (ph > 7) {
                suggestionContent.innerHTML += "<div class='warning'>PH Cao: Dùng dung dịch giảm PH, trộn 1 ít nước dầu, thay đổi giá thể</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>PH Lý Tưởng: Không cần điều chỉnh thêm</div>";
            }

            if (light < 12000) {
                suggestionContent.innerHTML += "<div class='warning'>Ánh Sáng Thấp: Bổ sung growlight, tăng thông gió, kiểm soát ẩm</div>";
            } else if (light > 18000) {
                suggestionContent.innerHTML += "<div class='warning'>Ánh Sáng Cao: Che chắn, lọc sáng, giảm cường độ và đặt đèn xa cây, hạn chế tảo</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>Ánh Sáng Lý Tưởng: Không cần điều chỉnh thêm</div>";
            }

            if (humid < 50) {
                suggestionContent.innerHTML += "<div class='warning'>Độ Ẩm Thấp: Tăng cường hệ thống tưới, sử dụng bể phụ trợ, cải thiện thông gió</div>";
            } else if (humid > 70) {
                suggestionContent.innerHTML += "<div class='warning'>Độ Ẩm Cao: Tăng cường thông gió, sử dụng máy hút ẩm, điều chỉnh nhiệt độ</div>";
            } else {
                suggestionContent.innerHTML += "<div class='ideal'>Độ Ẩm Lý Tưởng: Không cần điều chỉnh thêm</div>";
            }
        }

        function goBackToForm() {
            const suggestionDiv = document.getElementById('suggestion');
            suggestionDiv.classList.remove('show'); // Use class to trigger transition

            setTimeout(() => {
                suggestionDiv.style.display = 'none';
                document.getElementById('dataForm').reset();
                document.getElementById('summary').innerHTML = "";
                const formContainer = document.getElementById('formContainer');
                formContainer.style.display = "block";
                formContainer.classList.remove('fade-out');
            }, 500);
        }
    </script>

</body>
</html>
